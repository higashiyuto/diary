<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>やることリスト</title>
  <style>
    .todo-list {
      padding-left: 0;
    }

    .todo-list li {
      list-style: none;
      margin: 10px 0;
      padding-left: 1em;
      position: relative;
    }

    .todo-list li.checked::before {
      content: "✅ ";
      position: absolute;
      left: 0;
    }

    .todo-list li.checked a {
      text-decoration: line-through;
      color: gray;
    }
  </style>
</head>
<body>

  <h2>やることリスト</h2>
  <ul class="todo-list">
    <li data-id="task1">
      <a href="https://chronus.mercury-group.co.jp/index.html#/puncher" class="todo-link" target="_blank">出勤 Chronus</a>
    </li>
    <li data-id="task2">
      <a href="#" class="todo-link">出勤 e-staffing</a>
    </li>
    <li data-id="task3">
      <a href="https://dcmonlinecommunity.my.site.com/partnersites/login/?ec=302&start" class="todo-link" target="_blank">個人実績管理(オンコミ)</a>
    </li>
    <li data-id="task4">
      <a href="https://chronus.mercury-group.co.jp/index.html#/puncher" class="todo-link" target="_blank">退勤 Chronus</a>
    </li>
    <li data-id="task2">
      <a href="#" class="todo-link">退勤 e-staffing</a>
    </li>
  </ul>

  <script>
    const storageKey = "checkedTasks";
    const resetKey = "lastResetDate";

    // 保存されているチェック状態を取得
    const saved = JSON.parse(localStorage.getItem(storageKey)) || {};

    // チェック状態を復元
    document.querySelectorAll('.todo-list li').forEach(li => {
      const id = li.dataset.id;
      if (saved[id]) {
        li.classList.add("checked");
      }
    });

    // クリックイベント（チェックマークを付けて保存）
    document.querySelectorAll('.todo-link').forEach(link => {
      link.addEventListener('click', function (event) {
        const href = link.getAttribute('href');
        if (!href || href === "#") {
          event.preventDefault(); // 空リンクなら遷移させない
        }

        const li = link.closest("li");
        const id = li.dataset.id;

        if (!li.classList.contains("checked")) {
          li.classList.add("checked");
          saved[id] = true;
          localStorage.setItem(storageKey, JSON.stringify(saved));
        }
      });
    });

    // 24:00でlocalStorageをリセット（1分ごとにチェック）
    function resetIfNeeded() {
      const now = new Date();
      const today = now.toISOString().slice(0, 10); // "YYYY-MM-DD"
      const lastReset = localStorage.getItem(resetKey);

      if (lastReset !== today && now.getHours() === 0) {
        localStorage.removeItem(storageKey);
        localStorage.setItem(resetKey, today);
        location.reload(); // 表示を更新
      }
    }

    // 1分ごとに日付チェック
    setInterval(resetIfNeeded, 60 * 1000);
  </script>

</body>
</html>